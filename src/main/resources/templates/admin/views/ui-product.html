<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description"
	content="Responsive Admin &amp; Dashboard Template based on Bootstrap 5">
<meta name="author" content="Admin">
<meta name="keywords"
	content="adminkit, bootstrap, bootstrap 5, admin, dashboard, template, responsive, css, sass, html, theme, front-end, ui kit, web">
<link th:href="@{/fonts/fontawesome-free-6.4.0-web/css/all.css}"
	href="/fonts/fontawesome-free-6.4.0-web/css/all.css" rel="stylesheet"
	type="text/css" media="all" />
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT"
	crossorigin="anonymous" />
<link rel="preconnect" href="https://fonts.gstatic.com"
	th:href="@{https://fonts.gstatic.com}">
<link rel="shortcut icon" th:href="@{/admin/img/icons/icon-48x48.png}" />

<link rel="canonical" th:href="@{https://demo-basic.adminkit.io/}" />

<title>UI - Product</title>
<link th:href="@{/admin/css/admin.css}" rel="stylesheet" type="text/css"
	media="all">
<link th:href="@{/admin/css/app.css}" rel="stylesheet" type="text/css"
	media="all">
<link
	th:href="@{https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap}"
	rel="stylesheet" type="text/css" media="all">
</head>

<body>
	<div class="wrapper">

		<div th:replace="~{./admin/layout/sidebar ::  #sidebar}"></div>
		<div class="main">
			<div th:replace="~{./admin/layout/nav ::  #nav-admin}"></div>

			<main class="content">
				<div class="container-fluid p-0">

					<div class="mb-3">
						<!-- <h1 class="h3 d-inline align-middle">Form Thông Tin</h1> -->
						<h3 class="fw-bold">THÔNG TIN CHO PRODUCT</h3>
					</div>
					<div class="row">

						<div class="col-12 col-lg-6">

							<div class="card">
								<div class="card-header">
									<h5 class="card-title">Main Image</h5>
									<h6 class="card-subtitle text-muted">Hình ảnh chính của
										sản phẩm.</h6>
								</div>
								<div class="container" style="text-align: center;">
									<form class="card" method="post" th:object="${detailedImage}"
										th:action="@{/shoeshop/admin/ui-product}">
										<div class="square" id="imageSquare"
											style="border: 1px solid white; display: inline-block; margin: 0 auto;">
											<img th:if="${selectedImage != null}"
												th:src="${selectedImage}" class="selected-image" /> <img
												th:src="@{/images/product-images/__${mainImage}__}"
												alt="Image" style="max-width: 300px">
										</div>
									</form>
									<br>
								</div>
								<br>
							</div>

							<form class="card" method="post" th:object="${detailedImage}"
								th:action="@{/shoeshop/admin/list-product/updateImage}">
								<div class="card-header">
									<h5 class="card-title">Secondary Image</h5>
									<h6 class="card-subtitle text-muted">Hình ảnh để khách
										hàng xem chi tiết.</h6>
								</div>
								<!-- 3 ảnh chi tiết -->
								<div class="card-body">

									<input class="form-control" type="text" th:id="*{id_image}"
										th:field="*{id_image}" id="ee" th:value="${idImage}" />
									<div class="mb-3">

										<label for="detailedOne" class="form-label">Chọn hình
											chi tiết 1</label> <input class="form-control" type="file"
											id="detailedOne" th:field="*{detailedOne}" />
									</div>
									<input type="file" id="imageInput" th:field="*{mainImage}"
										style="display: none" />
									<div class="mb-3">
										<label for="detailedTwo" class="form-label">Chọn hình
											chi tiết 2</label> <input class="form-control" type="file"
											id="detailedTwo" th:field="*{detailedTwo}" />
									</div>
									<div class="mb-3">
										<label for="detailedThree" class="form-label">Chọn
											hình chi tiết 3</label> <input class="form-control" type="file"
											id="detailedThree" th:field="*{detailedThree}" />
									</div>
									<input class="form-control" type="text"
										th:field="*{product.id}" id="details" th:value="${idProduct}" />


									<button type="submit" class="btn btn-primary">Lưu Hình</button>
								</div>
							</form>

						</div>
						<div class="col-12 col-lg-6">
							<div class="card">
								<div class="card-header">
									<h5 class="card-title">Form Thông Tin</h5>
									<h6 class="card-subtitle text-muted">Form thông tin để
										nhập thông tin cho Sản phẩm.</h6>
								</div>
								<div class="card-body">
									<form class="container" method="post"
										th:action="@{/shoeshop/admin/ui-product}"
										th:object="${product}">
										<hr>
										<div class="row">
											<div class="mb-3 col-lg-12">
												<label for="" class="form-label"><b>ID?</b></label> <input
													type="text" class="form-control" th:field="*{id}"
													th:id="${id}" aria-describedby="helpId" placeholder=""
													oninput="document.getElementById('details').value = this.value" />
												<span th:if="${#fields.hasErrors('id')}" th:errors="*{id}"
													class="text-danger"></span>
											</div>

											<div class="mb-3 col-lg-12">
												<label for="" class="form-label"><b>Name?</b></label> <input
													type="text" class="form-control" th:field="*{name}" id=""
													aria-describedby="helpId" placeholder="" /> <span
													th:if="${#fields.hasErrors('name')}" th:errors="*{name}"
													class="text-danger"></span>
											</div>

											<div class="mb-3 col-lg-12">
												<label for="" class="form-label"><b>Price?</b></label> <input
													type="text" class="form-control" th:field="*{price}" id=""
													aria-describedby="helpId" placeholder="" /> <span
													th:if="${#fields.hasErrors('price')}" th:errors="*{price}"
													class="text-danger"></span>
											</div>
										</div>
										<div class="row">
											<div class="mb-3 col-lg-12">
												<label for="" class="form-label"><b>Quantity?</b></label> <input
													type="number" class="form-control" th:field="*{quantity}"
													id="" aria-describedby="helpId" placeholder="" /> <span
													th:if="${#fields.hasErrors('quantity')}"
													th:errors="*{quantity}" class="text-danger"></span>
											</div>
										</div>
										<div class="row">
											<label for="" class="form-label"><b>Description?</b></label>
											<div class="form-floating">
												<textarea class="form-control"
													placeholder="Nhập nội dung..."
													id="exampleFormControlTextarea1" rows="10"
													th:field="*{description}"></textarea>
												<label for="exampleFormControlTextarea1">info...</label> <span
													th:if="${#fields.hasErrors('description')}"
													th:errors="*{description}" class="text-danger"></span>
											</div>
										</div>
										<div class="row">
											<div class="col-lg-12">
												<label for="" class="form-label"><b>Trạng thái:</b></label>
												<div class="form-check">
													<input class="form-check-input" type="radio" name="status"
														th:field="*{status}" id="statusActive" th:value="true"
														th:checked="${product.status}" /> <label
														class="form-check-label" for="statusActive">Đang
														bán</label>
												</div>
												<div class="form-check">
													<input class="form-check-input" type="radio"
														th:field="*{status}" name="status" id="statusInactive"
														th:value="false" th:checked="${!product.status}" /> <label
														class="form-check-label" for="statusInactive">Ngừng
														kinh doanh</label>
												</div>
												<span th:if="${#fields.hasErrors('status')}"
													th:errors="*{status}" class="text-danger"></span>
											</div>
										</div>
										<div class="row mt-5 mb-3">
											<div class="form-floating col-lg-6">
												<select class="form-select" id="exampleFormControlSelect1"
													aria-label="Chọn một lựa chọn" th:field="*{brand.id}">
													<option th:each="brand : ${brands}" th:value="${brand.id}"
														th:selected="${brand.id == product.brand?.id}"
														th:text="${brand.name}"></option>
												</select> <label for="exampleFormControlSelect1">Brand</label>
											</div>
											<div class="form-floating col-lg-6">
												<select class="form-select" id="exampleFormControlSelect2"
													aria-label="Chọn một lựa chọn" th:field="*{category.id}">
													<option th:each="category : ${categories}"
														th:value="${category.id}"
														th:selected="${category.id == product.category?.id}"
														th:text="${category.name}"></option>
												</select> <label for="exampleFormControlSelect2">Categories</label>
											</div>
										</div>
										<div class="me-auto mt-5">
											<button type="submit"
												formaction="/shoeshop/admin/list-product/create"
												class="btn btn-primary ms-auto">
												Create <i class="fa-solid fa-plus"></i>
											</button>
											<button type="submit"
												formaction="/shoeshop/admin/list-product/update"
												class="btn btn-info ms-auto">
												Update <i class="fa-solid fa-pen"></i>
											</button>
										</div>
									</form>

								</div>
							</div>
						</div>

					</div>

				</div>
			</main>

			<div th:if="${successMessage}" id="successDialog"
				class="dialog-overlay">
				<div class="dialog-content">
					<p th:text="${successMessage}"></p>
				</div>
			</div>
			<div th:if="${failed}" id="successDialog" class="dialog-overlay">
				<div class="dialog-content-failed">
					<p th:text="${failed}"></p>
				</div>
			</div>
			<div th:replace="~{./admin/layout/footer ::  #footer-admin}"></div>
		</div>
	</div>
	<script th:inline="javascript">
		setTimeout(function() {
			document.getElementById("successDialog").style.display = "none";
		}, 1000); // 5000 milliseconds = 5 seconds
	</script>
	<script th:inline="javascript">
		document.addEventListener('DOMContentLoaded',
				function() {
					var idInput = document
							.getElementById(/* id của input đầu tiên */);
					var detailsInput = document.getElementById('details');

					idInput.addEventListener('input', function() {
						detailsInput.value = idInput.value;
					});
				});
	</script>

	<script th:src="@{/admin/js/app.js}"></script>
	<script th:inline="javascript">
		/*<![CDATA[*/
		const square = document.getElementById('imageSquare');
		const imageInput = document.getElementById('imageInput');

		square.addEventListener('click', function() {
			// Trigger the file selection dialog
			imageInput.click();
		});

		imageInput.addEventListener('change', function(event) {
			const file = event.target.files[0];

			// Check if a file was selected
			if (file) {
				const reader = new FileReader();

				// Read the contents of the file
				reader.onload = function() {
					const imageUrl = reader.result;

					// Create an image element and set the source
					const image = document.createElement('img');
					image.src = imageUrl;
					image.classList.add('selected-image');

					// Clear the square and append the image
					square.innerHTML = '';
					square.appendChild(image);

					// Send the image to the server via AJAX
					const formData = new FormData();
					formData.append('file', file);

					const xhr = new XMLHttpRequest();
					xhr.open('POST', '/upload', true);
					xhr.onload = function() {
						if (xhr.status === 200) {
							console.log('Image uploaded successfully');
						} else {
							console.error('Error uploading image');
						}
					};
					xhr.send(formData);
				};

				// Read the file as data URL
				reader.readAsDataURL(file);
			}
		});
		/*]]>*/
	</script>

</body>

</html>